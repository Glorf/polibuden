INSERT INTO PRACOWNICY(ID_PRAC, NAZWISKO, ETAT, ZATRUDNIONY, PLACA_POD, ID_ZESP) VALUES (250, 'KOWALSKI', 'ASYSTENT', DATE'2015-01-13', 1500, 10);
INSERT INTO PRACOWNICY(ID_PRAC, NAZWISKO, ETAT, ZATRUDNIONY, PLACA_POD, ID_ZESP) VALUES (260, 'ADAMSKI', 'ASYSTENT', DATE'2014-09-10', 1500, 10);
INSERT INTO PRACOWNICY(ID_PRAC, NAZWISKO, ETAT, ZATRUDNIONY, PLACA_POD, PLACA_DOD, ID_ZESP) VALUES (270, 'NOWAK', 'ADIUNKT', DATE'1990-05-01', 2050, 540, 20);
SELECT * FROM PRACOWNICY WHERE ID_PRAC BETWEEN 250 AND 270;
UPDATE PRACOWNICY SET PLACA_POD=1.1*PLACA_POD, PLACA_DOD=NVL(1.2*PLACA_DOD,100) WHERE ID_PRAC BETWEEN 250 AND 270;
SELECT * FROM PRACOWNICY WHERE ID_PRAC BETWEEN  250 AND 270;
INSERT INTO ZESPOLY(ID_ZESP, NAZWA, ADRES) VALUES (60, 'BAZY DANYCH', 'PIOTROWO 2');
SELECT * FROM ZESPOLY WHERE ID_ZESP=60;
UPDATE PRACOWNICY SET ID_ZESP=(SELECT ID_ZESP FROM ZESPOLY WHERE NAZWA='BAZY DANYCH') WHERE ID_PRAC BETWEEN 250 AND 270;
SELECT * FROM PRACOWNICY WHERE ID_ZESP=60;
UPDATE PRACOWNICY SET ID_SZEFA=(SELECT ID_PRAC FROM PRACOWNICY WHERE NAZWISKO='MORZY') WHERE ID_ZESP=(SELECT ID_ZESP FROM ZESPOLY WHERE NAZWA='BAZY DANYCH');
SELECT * FROM PRACOWNICY WHERE ID_SZEFA=(SELECT ID_PRAC FROM PRACOWNICY WHERE NAZWISKO='MORZY');
DELETE FROM ZESPOLY WHERE NAZWA='BAZY DANYCH'; -- Nie można - rekordy podrzędne
DELETE FROM PRACOWNICY WHERE ID_ZESP=(SELECT ID_ZESP FROM ZESPOLY WHERE NAZWA='BAZY DANYCH');
DELETE FROM ZESPOLY WHERE NAZWA='BAZY DANYCH'; -- Teraz można
SELECT * FROM ZESPOLY;
SELECT NAZWISKO, PLACA_POD, SREDNIA*0.1 AS PODWYZKA FROM PRACOWNICY NATURAL JOIN (SELECT ID_ZESP, AVG(PLACA_POD) AS SREDNIA FROM PRACOWNICY GROUP BY ID_ZESP);
UPDATE PRACOWNICY p SET p.PLACA_POD=p.PLACA_POD+(SELECT AVG(r.PLACA_POD) AS SREDNIA FROM PRACOWNICY r WHERE p.ID_ZESP=r.ID_ZESP GROUP BY r.ID_ZESP)*0.1;
SELECT NAZWISKO, PLACA_POD FROM PRACOWNICY;
SELECT * FROM PRACOWNICY WHERE PLACA_POD=(SELECT MIN(PLACA_POD) FROM PRACOWNICY);
UPDATE PRACOWNICY SET PLACA_POD=(SELECT AVG(PLACA_POD) FROM PRACOWNICY) WHERE PLACA_POD=(SELECT MIN(PLACA_POD) FROM PRACOWNICY);
SELECT * FROM PRACOWNICY WHERE ID_PRAC=200;
SELECT NAZWISKO, PLACA_DOD FROM PRACOWNICY WHERE ID_ZESP=20;
UPDATE PRACOWNICY SET PLACA_DOD=(SELECT AVG(PLACA_POD) FROM PRACOWNICY WHERE ID_SZEFA=(SELECT ID_PRAC FROM PRACOWNICY WHERE NAZWISKO='MORZY')) WHERE ID_ZESP=20;
SELECT NAZWISKO, PLACA_DOD FROM PRACOWNICY WHERE ID_ZESP=20;
SELECT NAZWISKO, PLACA_POD FROM PRACOWNICY WHERE ID_ZESP=(SELECT ID_ZESP FROM ZESPOLY WHERE NAZWA='SYSTEMY ROZPROSZONE');
UPDATE PRACOWNICY SET PLACA_POD=PLACA_POD*1.25 WHERE ID_ZESP=(SELECT ID_ZESP FROM ZESPOLY WHERE NAZWA='SYSTEMY ROZPROSZONE');
SELECT NAZWISKO, PLACA_POD FROM PRACOWNICY WHERE ID_ZESP=(SELECT ID_ZESP FROM ZESPOLY WHERE NAZWA='SYSTEMY ROZPROSZONE');
SELECT p.NAZWISKO AS PRACOWNIK, s.NAZWISKO AS SZEF FROM PRACOWNICY p JOIN PRACOWNICY s ON p.ID_SZEFA = s.ID_PRAC WHERE p.ID_SZEFA=(SELECT r.ID_PRAC FROM PRACOWNICY r WHERE r.NAZWISKO='MORZY');
DELETE FROM (SELECT p.ID_PRAC, s.NAZWISKO FROM PRACOWNICY p JOIN PRACOWNICY s ON p.ID_SZEFA=s.ID_PRAC) WHERE NAZWISKO='MORZY';
CREATE SEQUENCE PRAC_SEQ START WITH 300 INCREMENT BY 10;
INSERT INTO PRACOWNICY(ID_PRAC, NAZWISKO, ETAT, PLACA_POD) VALUES (PRAC_SEQ.nextval, 'Trąbczyński', 'STAZYSTA', 1000);
UPDATE PRACOWNICY SET PLACA_DOD=PRAC_SEQ.currval WHERE NAZWISKO='Trąbczyński';
DELETE FROM PRACOWNICY WHERE NAZWISKO='Trąbczyński';
CREATE SEQUENCE MALA_SEQ MAXVALUE 10;
SELECT MALA_SEQ.nextval FROM dual;
DROP SEQUENCE MALA_SEQ;